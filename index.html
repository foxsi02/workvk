<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WorkVK - –§—Ä–∏–ª–∞–Ω—Å –±–∏—Ä–∂–∞</title>
    
    <!-- VK Mini Apps SDK -->
    <script src="https://unpkg.com/@vkontakte/vk-bridge/dist/browser.min.js"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* –ë–ê–ó–û–í–´–ï –°–¢–ò–õ–ò –°–†–ê–ó–£ –í HTML */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        :root {
            --primary: #4f46e5;
            --primary-dark: #4338ca;
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --dark: #1f2937;
            --light: #f8fafc;
            --gray-200: #e5e7eb;
            --gray-300: #d1d5db;
            --gray-500: #6b7280;
            --gray-700: #374151;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --radius: 12px;
        }
        
        body {
            background: var(--light);
            color: var(--dark);
            line-height: 1.6;
        }
        
        #app {
            max-width: 428px;
            margin: 0 auto;
            background: white;
            min-height: 100vh;
            position: relative;
        }
        
        /* –®–ê–ü–ö–ê */
        .header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            padding: 16px 20px;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 24px;
            font-weight: 700;
        }
        
        .header-actions {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }
        
        /* –ù–ê–í–ò–ì–ê–¶–ò–Ø */
        .nav {
            display: flex;
            background: white;
            border-bottom: 1px solid var(--gray-200);
            padding: 0 8px;
            position: sticky;
            top: 68px;
            z-index: 90;
        }
        
        .nav-btn {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            padding: 12px 8px;
            background: none;
            border: none;
            color: var(--gray-500);
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
        }
        
        .nav-btn i {
            font-size: 20px;
        }
        
        .nav-btn.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }
        
        .nav-btn:hover {
            color: var(--primary);
        }
        
        /* –û–°–ù–û–í–ù–û–ô –ö–û–ù–¢–ï–ù–¢ */
        .main-content {
            padding: 20px;
            padding-bottom: 80px;
        }
        
        .screen {
            display: none;
        }
        
        .screen.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* –ö–ù–û–ü–ö–ò */
        .btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 12px 20px;
            border: none;
            border-radius: var(--radius);
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            justify-content: center;
        }
        
        .btn-primary {
            background: var(--primary);
            color: white;
        }
        
        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-1px);
        }
        
        .btn-outline {
            background: transparent;
            color: var(--primary);
            border: 2px solid var(--primary);
        }
        
        .btn-outline:hover {
            background: var(--primary);
            color: white;
        }
        
        .btn-large {
            padding: 14px 24px;
            font-size: 16px;
        }
        
        /* –ö–ê–†–¢–û–ß–ö–ò –ó–ê–î–ê–ù–ò–ô */
        .task-card {
            background: white;
            border: 1px solid var(--gray-200);
            border-radius: var(--radius);
            padding: 16px;
            margin-bottom: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .task-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }
        
        .task-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 8px;
        }
        
        .task-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--dark);
        }
        
        .task-price {
            font-size: 18px;
            font-weight: 700;
            color: var(--primary);
        }
        
        .task-description {
            color: var(--gray-700);
            font-size: 14px;
            margin-bottom: 12px;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        .task-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 12px;
            color: var(--gray-500);
        }
        
        .task-category {
            background: var(--gray-200);
            padding: 4px 8px;
            border-radius: 12px;
            font-weight: 500;
        }
        
        /* –§–û–†–ú–´ */
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--gray-700);
        }
        
        .form-input, .form-textarea, .form-select {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid var(--gray-200);
            border-radius: var(--radius);
            font-size: 16px;
            transition: all 0.3s ease;
        }
        
        .form-input:focus, .form-textarea:focus, .form-select:focus {
            outline: none;
            border-color: var(--primary);
        }
        
        .form-textarea {
            resize: vertical;
            min-height: 120px;
        }
        
        /* –ì–õ–ê–í–ù–´–ô –≠–ö–†–ê–ù */
        .hero-section {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            padding: 30px 24px;
            border-radius: var(--radius);
            margin-bottom: 24px;
            text-align: center;
        }
        
        .hero-content h1 {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 8px;
        }
        
        .hero-stats {
            display: flex;
            justify-content: space-around;
            margin-top: 24px;
        }
        
        .stat {
            text-align: center;
        }
        
        .stat-number {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 4px;
        }
        
        .stat-label {
            font-size: 12px;
            opacity: 0.8;
        }
        
        /* –ö–ê–¢–ï–ì–û–†–ò–ò */
        .categories-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-bottom: 24px;
        }
        
        .category-card {
            background: white;
            border: 1px solid var(--gray-200);
            border-radius: var(--radius);
            padding: 16px 12px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .category-card:hover {
            transform: translateY(-2px);
            border-color: var(--primary);
        }
        
        .category-card i {
            font-size: 24px;
            color: var(--primary);
            margin-bottom: 8px;
            display: block;
        }
        
        /* –ú–û–î–ê–õ–¨–ù–´–ï –û–ö–ù–ê */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .modal.active {
            display: flex;
        }
        
        .modal-content {
            background: white;
            border-radius: var(--radius);
            padding: 24px;
            width: 100%;
            max-width: 400px;
            animation: modalSlideIn 0.3s ease;
        }
        
        @keyframes modalSlideIn {
            from { opacity: 0; transform: scale(0.9) translateY(-20px); }
            to { opacity: 1; transform: scale(1) translateY(0); }
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }
        
        .modal-header h3 {
            font-size: 20px;
            font-weight: 600;
        }
        
        .btn-close {
            background: none;
            border: none;
            font-size: 20px;
            color: var(--gray-500);
            cursor: pointer;
            padding: 4px;
        }
        
        /* –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø */
        .notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%) translateY(-100px);
            background: var(--success);
            color: white;
            padding: 12px 20px;
            border-radius: var(--radius);
            z-index: 1100;
            transition: all 0.3s ease;
        }
        
        .notification.show {
            transform: translateX(-50%) translateY(0);
        }
        
        /* –ü–£–°–¢–´–ï –°–û–°–¢–û–Ø–ù–ò–Ø */
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: var(--gray-500);
        }
        
        .empty-state i {
            font-size: 48px;
            margin-bottom: 16px;
            opacity: 0.5;
        }
        
        .empty-state h3 {
            margin-bottom: 8px;
            color: var(--gray-600);
        }
        
        /* –ß–ê–¢ */
        .chat-messages {
            max-height: 300px;
            overflow-y: auto;
            margin-bottom: 16px;
        }
        
        .message {
            margin-bottom: 12px;
            display: flex;
        }
        
        .message.outgoing {
            justify-content: flex-end;
        }
        
        .message-content {
            background: var(--gray-200);
            padding: 12px 16px;
            border-radius: 18px;
            max-width: 80%;
        }
        
        .message.outgoing .message-content {
            background: var(--primary);
            color: white;
        }
        
        .chat-input {
            display: flex;
            gap: 8px;
        }
        
        .chat-input input {
            flex: 1;
        }
        
        /* –ê–î–ê–ü–¢–ò–í–ù–û–°–¢–¨ */
        @media (max-width: 380px) {
            .main-content {
                padding: 16px;
            }
            
            .categories-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div id="app">
        <!-- –®–∞–ø–∫–∞ -->
        <header class="header">
            <div class="header-content">
                <div class="logo" onclick="workVK.showScreen('home')">
                    <i class="fas fa-rocket"></i>
                    <span>WorkVK</span>
                </div>
                <div class="header-actions">
                    <div id="userInfo" class="user-info" style="display: none;">
                        <img id="userAvatar" src="" alt="Avatar" class="avatar">
                        <span id="userName"></span>
                    </div>
                    <div id="authSection" class="auth-section">
                        <button class="btn btn-outline" onclick="workVK.vkLogin()">
                            <i class="fas fa-sign-in-alt"></i>–í–æ–π—Ç–∏
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
        <nav class="nav">
            <button class="nav-btn active" onclick="workVK.showScreen('home')">
                <i class="fas fa-home"></i>
                <span>–ì–ª–∞–≤–Ω–∞—è</span>
            </button>
            <button class="nav-btn" onclick="workVK.showScreen('tasks')">
                <i class="fas fa-tasks"></i>
                <span>–ó–∞–¥–∞–Ω–∏—è</span>
            </button>
            <button class="nav-btn" onclick="workVK.showScreen('create')">
                <i class="fas fa-plus-circle"></i>
                <span>–°–æ–∑–¥–∞—Ç—å</span>
            </button>
            <button class="nav-btn" onclick="workVK.showScreen('deals')">
                <i class="fas fa-handshake"></i>
                <span>–°–¥–µ–ª–∫–∏</span>
            </button>
            <button class="nav-btn" onclick="workVK.showScreen('profile')">
                <i class="fas fa-user"></i>
                <span>–ü—Ä–æ—Ñ–∏–ª—å</span>
            </button>
        </nav>

        <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
        <main class="main-content">
            <!-- –ì–ª–∞–≤–Ω–∞—è -->
            <div id="homeScreen" class="screen active">
                <div class="hero-section">
                    <div class="hero-content">
                        <h1>–ù–∞–π–¥–∏ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è –¥–ª—è –ª—é–±–æ–π –∑–∞–¥–∞—á–∏</h1>
                        <p>–ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ —Å–¥–µ–ª–∫–∏ —á–µ—Ä–µ–∑ VK Pay ‚Ä¢ –¢—ã—Å—è—á–∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö —Ñ—Ä–∏–ª–∞–Ω—Å–µ—Ä–æ–≤</p>
                        <button class="btn btn-primary btn-large" onclick="workVK.showScreen('create')">
                            <i class="fas fa-plus"></i>–†–∞–∑–º–µ—Å—Ç–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ
                        </button>
                    </div>
                    <div class="hero-stats">
                        <div class="stat">
                            <div class="stat-number" id="statsTasks">0</div>
                            <div class="stat-label">–∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–¥–∞–Ω–∏–π</div>
                        </div>
                        <div class="stat">
                            <div class="stat-number" id="statsUsers">0</div>
                            <div class="stat-label">–∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π –æ–Ω–ª–∞–π–Ω</div>
                        </div>
                        <div class="stat">
                            <div class="stat-number" id="statsMoney">0</div>
                            <div class="stat-label">—Ä—É–±. –≤—ã–ø–ª–∞—á–µ–Ω–æ</div>
                        </div>
                    </div>
                </div>

                <div class="categories-section">
                    <h2 style="margin-bottom: 16px; font-size: 20px;">–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</h2>
                    <div class="categories-grid" id="categoriesGrid">
                        <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∑–∞–≥—Ä—É–∑—è—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
                    </div>
                </div>

                <div class="tasks-section">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                        <h2 style="font-size: 20px;">–°–≤–µ–∂–∏–µ –∑–∞–¥–∞–Ω–∏—è</h2>
                        <button class="btn btn-outline" onclick="workVK.showScreen('tasks')">
                            –í—Å–µ –∑–∞–¥–∞–Ω–∏—è <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                    <div id="tasksList">
                        <!-- –ó–∞–¥–∞–Ω–∏—è –∑–∞–≥—Ä—É–∑—è—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
                    </div>
                </div>
            </div>

            <!-- –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è -->
            <div id="createScreen" class="screen">
                <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 20px;">
                    <button class="btn btn-outline" onclick="workVK.showScreen('home')">
                        <i class="fas fa-arrow-left"></i>
                    </button>
                    <h2 style="font-size: 20px;">–ù–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ</h2>
                </div>

                <div class="create-form">
                    <div class="form-group">
                        <label>–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è</label>
                        <input type="text" id="taskTitle" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –î–∏–∑–∞–π–Ω –ª–æ–≥–æ—Ç–∏–ø–∞ –¥–ª—è –∫–æ—Ñ–µ–π–Ω–∏" class="form-input">
                    </div>

                    <div class="form-group">
                        <label>–û–ø–∏—Å–∞–Ω–∏–µ</label>
                        <textarea id="taskDescription" placeholder="–û–ø–∏—à–∏—Ç–µ –ø–æ–¥—Ä–æ–±–Ω–æ, —á—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å..." class="form-textarea" rows="5"></textarea>
                    </div>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 20px;">
                        <div class="form-group">
                            <label>–ë—é–¥–∂–µ—Ç (—Ä—É–±.)</label>
                            <input type="number" id="taskPrice" placeholder="5000" class="form-input" oninput="workVK.updateTotalAmount()">
                        </div>
                        <div class="form-group">
                            <label>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                            <select id="taskCategory" class="form-select">
                                <option value="design">–î–∏–∑–∞–π–Ω</option>
                                <option value="development">–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞</option>
                                <option value="text">–¢–µ–∫—Å—Ç—ã</option>
                                <option value="marketing">–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥</option>
                                <option value="video">–í–∏–¥–µ–æ</option>
                                <option value="audio">–ê—É–¥–∏–æ</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label style="display: flex; align-items: flex-start; gap: 12px; cursor: pointer;">
                            <input type="checkbox" id="safeDeal" checked style="margin-top: 2px;">
                            <span>–ë–µ–∑–æ–ø–∞—Å–Ω–∞—è —Å–¥–µ–ª–∫–∞ —á–µ—Ä–µ–∑ VK Pay</span>
                        </label>
                        <small style="display: block; margin-top: 4px; color: var(--gray-500);">
                            –î–µ–Ω—å–≥–∏ –±—É–¥—É—Ç –∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω—ã –¥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã
                        </small>
                    </div>

                    <button class="btn btn-primary btn-large" onclick="workVK.createTask()">
                        <i class="fas fa-paper-plane"></i>–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –∑–∞ <span id="totalAmount">0</span>‚ÇΩ
                    </button>
                </div>
            </div>

            <!-- –í—Å–µ –∑–∞–¥–∞–Ω–∏—è -->
            <div id="tasksScreen" class="screen">
                <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 20px;">
                    <button class="btn btn-outline" onclick="workVK.showScreen('home')">
                        <i class="fas fa-arrow-left"></i>
                    </button>
                    <h2 style="font-size: 20px;">–í—Å–µ –∑–∞–¥–∞–Ω–∏—è</h2>
                </div>

                <div id="allTasksList">
                    <!-- –í—Å–µ –∑–∞–¥–∞–Ω–∏—è –∑–∞–≥—Ä—É–∑—è—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
                </div>
            </div>

            <!-- –ü—Ä–æ—Ñ–∏–ª—å -->
            <div id="profileScreen" class="screen">
                <div class="profile-header" style="text-align: center; padding: 24px 0; border-bottom: 1px solid var(--gray-200); margin-bottom: 20px;">
                    <img id="profileAvatar" src="" alt="Avatar" style="width: 80px; height: 80px; border-radius: 50%; border: 4px solid var(--primary); margin-bottom: 12px;">
                    <h2 id="profileName" style="margin-bottom: 16px;"></h2>
                    <div style="display: flex; justify-content: space-around;">
                        <div class="profile-stat">
                            <div class="stat-value" id="completedTasks" style="font-size: 20px; font-weight: 700; color: var(--primary);">0</div>
                            <div class="stat-label" style="font-size: 12px; color: var(--gray-500);">–≤—ã–ø–æ–ª–Ω–µ–Ω–æ</div>
                        </div>
                        <div class="profile-stat">
                            <div class="stat-value" id="userRating" style="font-size: 20px; font-weight: 700; color: var(--primary);">5.0</div>
                            <div class="stat-label" style="font-size: 12px; color: var(--gray-500);">—Ä–µ–π—Ç–∏–Ω–≥</div>
                        </div>
                        <div class="profile-stat">
                            <div class="stat-value" id="userBalance" style="font-size: 20px; font-weight: 700; color: var(--primary);">0</div>
                            <div class="stat-label" style="font-size: 12px; color: var(--gray-500);">–±–∞–ª–∞–Ω—Å</div>
                        </div>
                    </div>
                </div>

                <div style="border-bottom: 1px solid var(--gray-200); margin-bottom: 20px;">
                    <button class="tab-btn active" onclick="workVK.showTab('myTasks')" style="flex: 1; padding: 12px 8px; background: none; border: none; border-bottom: 3px solid var(--primary); color: var(--primary); font-weight: 500; cursor: pointer;">
                        –ú–æ–∏ –∑–∞–¥–∞–Ω–∏—è
                    </button>
                </div>

                <div id="myTasksTab">
                    <h3 style="margin-bottom: 16px;">–ê–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è</h3>
                    <div id="userTasksList">
                        <!-- –ó–∞–¥–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
                    </div>
                </div>
            </div>

            <!-- –°–¥–µ–ª–∫–∏ -->
            <div id="dealsScreen" class="screen">
                <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 20px;">
                    <button class="btn btn-outline" onclick="workVK.showScreen('home')">
                        <i class="fas fa-arrow-left"></i>
                    </button>
                    <h2 style="font-size: 20px;">–ú–æ–∏ —Å–¥–µ–ª–∫–∏</h2>
                </div>

                <div id="dealsList">
                    <!-- –°–¥–µ–ª–∫–∏ –∑–∞–≥—Ä—É–∑—è—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
                </div>
            </div>
        </main>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—Ö–æ–¥–∞ -->
        <div id="loginModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>–í—Ö–æ–¥ –≤ WorkVK</h3>
                    <button class="btn btn-close" onclick="workVK.closeModal('loginModal')">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <p style="margin-bottom: 20px;">–í–æ–π–¥–∏—Ç–µ —á–µ—Ä–µ–∑ –≤–∞—à –∞–∫–∫–∞—É–Ω—Ç VK</p>
                    <button class="btn btn-primary btn-large" onclick="workVK.vkLogin()" style="width: 100%;">
                        <i class="fab fa-vk"></i>–í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ VK
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // –í–°–¢–†–û–ï–ù–ù–´–ô script.js –î–õ–Ø –ù–ê–î–ï–ñ–ù–û–°–¢–ò
        class WorkVK {
            constructor() {
                this.currentUser = null;
                this.tasks = [];
                this.currentScreen = 'home';
                this.init();
            }

            async init() {
                console.log('üöÄ WorkVK –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è...');
                
                try {
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º VK Bridge
                    if (window.vkBridge) {
                        await vkBridge.send('VKWebAppInit');
                        console.log('‚úÖ VK Bridge –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
                        
                        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—Ö–æ–¥
                        await this.vkLogin();
                    } else {
                        console.log('‚ö†Ô∏è VK Bridge –Ω–µ –Ω–∞–π–¥–µ–Ω');
                        this.showNotification('VK Bridge –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω', 'error');
                    }
                } catch (error) {
                    console.error('‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:', error);
                }
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ
                this.loadHomeData();
                this.renderCategories();
            }

            async vkLogin() {
                try {
                    console.log('üîê –ü–æ–ø—ã—Ç–∫–∞ –≤—Ö–æ–¥–∞ —á–µ—Ä–µ–∑ VK...');
                    
                    // –ü–æ–ª—É—á–∞–µ–º —Ç–æ–∫–µ–Ω
                    const auth = await vkBridge.send('VKWebAppGetAuthToken', {
                        app_id: 54305771,
                        scope: 'friends,photos,messages,pay'
                    });
                    
                    // –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
                    const userInfo = await vkBridge.send('VKWebAppGetUserInfo');
                    
                    this.currentUser = {
                        id: userInfo.id,
                        firstName: userInfo.first_name,
                        lastName: userInfo.last_name,
                        photo: userInfo.photo_200,
                        accessToken: auth.access_token
                    };
                    
                    this.showUserInfo();
                    this.closeModal('loginModal');
                    this.showNotification(`–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, ${userInfo.first_name}!`);
                    
                    console.log('‚úÖ –£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥:', this.currentUser);
                    
                } catch (error) {
                    console.error('‚ùå –û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞:', error);
                    this.showNotification('–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞ —á–µ—Ä–µ–∑ VK', 'error');
                }
            }

            showUserInfo() {
                const userInfo = document.getElementById('userInfo');
                const authSection = document.getElementById('authSection');
                const profileName = document.getElementById('profileName');
                const profileAvatar = document.getElementById('profileAvatar');
                const userAvatar = document.getElementById('userAvatar');
                const userName = document.getElementById('userName');

                if (this.currentUser) {
                    userInfo.style.display = 'flex';
                    authSection.style.display = 'none';
                    
                    if (userName) userName.textContent = `${this.currentUser.firstName} ${this.currentUser.lastName}`;
                    if (profileName) profileName.textContent = `${this.currentUser.firstName} ${this.currentUser.lastName}`;
                    
                    const avatarUrl = this.currentUser.photo;
                    if (profileAvatar) profileAvatar.src = avatarUrl;
                    if (userAvatar) userAvatar.src = avatarUrl;
                }
            }

            // –°–ò–°–¢–ï–ú–ê –≠–ö–†–ê–ù–û–í
            showScreen(screenName) {
                console.log('üì± –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —ç–∫—Ä–∞–Ω:', screenName);
                
                // –°–∫—Ä—ã—Ç—å –≤—Å–µ —ç–∫—Ä–∞–Ω—ã
                document.querySelectorAll('.screen').forEach(screen => {
                    screen.classList.remove('active');
                });

                // –°–∫—Ä—ã—Ç—å –≤—Å–µ –∫–Ω–æ–ø–∫–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
                document.querySelectorAll('.nav-btn').forEach(btn => {
                    btn.classList.remove('active');
                });

                // –ü–æ–∫–∞–∑–∞—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–π —ç–∫—Ä–∞–Ω
                const targetScreen = document.getElementById(screenName + 'Screen');
                if (targetScreen) {
                    targetScreen.classList.add('active');
                    this.currentScreen = screenName;
                }

                // –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –∫–Ω–æ–ø–∫—É –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
                const targetNavBtn = document.querySelector(`.nav-btn[onclick="showScreen('${screenName}')"]`);
                if (targetNavBtn) {
                    targetNavBtn.classList.add('active');
                }

                // –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–ª—è —ç–∫—Ä–∞–Ω–∞
                this.loadScreenData(screenName);
            }

            loadScreenData(screenName) {
                switch(screenName) {
                    case 'home':
                        this.loadHomeData();
                        break;
                    case 'tasks':
                        this.loadTasksData();
                        break;
                    case 'profile':
                        this.loadProfileData();
                        break;
                    case 'deals':
                        this.loadDealsData();
                        break;
                    case 'create':
                        this.updateTotalAmount();
                        break;
                }
            }

            // –ó–ê–ì–†–£–ó–ö–ê –î–ê–ù–ù–´–•
            async loadHomeData() {
                try {
                    const response = await fetch('/api/tasks/popular');
                    const data = await response.json();
                    
                    if (data.success) {
                        this.tasks = data.tasks;
                        this.renderTasks(data.tasks, 'tasksList');
                        this.updateStats();
                    }
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –≥–ª–∞–≤–Ω–æ–π:', error);
                    // –î–µ–º–æ-–¥–∞–Ω–Ω—ã–µ
                    this.renderTasks([{
                        id: '1',
                        title: "–î–∏–∑–∞–π–Ω –ª–æ–≥–æ—Ç–∏–ø–∞ –¥–ª—è –∫–æ—Ñ–µ–π–Ω–∏",
                        description: "–ù—É–∂–µ–Ω —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –ª–æ–≥–æ—Ç–∏–ø –≤ —Å–∏–Ω–∏—Ö —Ç–æ–Ω–∞—Ö",
                        price: 5000,
                        category: "design",
                        responsesCount: 3
                    }], 'tasksList');
                }
            }

            async loadTasksData() {
                try {
                    const response = await fetch('/api/tasks');
                    const data = await response.json();
                    
                    if (data.success) {
                        this.renderTasks(data.tasks, 'allTasksList');
                    }
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–¥–∞–Ω–∏–π:', error);
                }
            }

            renderTasks(tasks, containerId) {
                const container = document.getElementById(containerId);
                if (!container) return;

                if (tasks.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-tasks"></i>
                            <h3>–ó–∞–¥–∞–Ω–∏–π –ø–æ–∫–∞ –Ω–µ—Ç</h3>
                            <p>–ë—É–¥—å—Ç–µ –ø–µ—Ä–≤—ã–º, –∫—Ç–æ —Ä–∞–∑–º–µ—Å—Ç–∏—Ç –∑–∞–¥–∞–Ω–∏–µ!</p>
                        </div>
                    `;
                    return;
                }

                container.innerHTML = tasks.map(task => `
                    <div class="task-card" onclick="workVK.showTaskDetails('${task.id}')">
                        <div class="task-header">
                            <div class="task-title">${task.title}</div>
                            <div class="task-price">${task.price}‚ÇΩ</div>
                        </div>
                        <div class="task-description">${task.description}</div>
                        <div class="task-meta">
                            <span class="task-category">${this.getCategoryName(task.category)}</span>
                            <span>${task.responsesCount || 0} –æ—Ç–∫–ª–∏–∫–æ–≤</span>
                        </div>
                    </div>
                `).join('');
            }

            // –°–û–ó–î–ê–ù–ò–ï –ó–ê–î–ê–ù–ò–Ø
            async createTask() {
                if (!this.currentUser) {
                    this.showModal('loginModal');
                    return;
                }

                const title = document.getElementById('taskTitle').value;
                const description = document.getElementById('taskDescription').value;
                const price = parseInt(document.getElementById('taskPrice').value);
                const category = document.getElementById('taskCategory').value;
                const safeDeal = document.getElementById('safeDeal').checked;

                if (!title || !description || !price) {
                    this.showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è', 'error');
                    return;
                }

                try {
                    const response = await fetch('/api/tasks', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            title,
                            description,
                            price,
                            category,
                            safeDeal
                        })
                    });

                    const data = await response.json();

                    if (data.success) {
                        this.showNotification('–ó–∞–¥–∞–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–æ! üéâ');
                        this.showScreen('home');
                        this.resetCreateForm();
                    } else {
                        this.showNotification(data.error, 'error');
                    }
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–¥–∞–Ω–∏—è:', error);
                    this.showNotification('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–¥–∞–Ω–∏—è', 'error');
                }
            }

            resetCreateForm() {
                document.getElementById('taskTitle').value = '';
                document.getElementById('taskDescription').value = '';
                document.getElementById('taskPrice').value = '';
                document.getElementById('taskCategory').value = 'design';
                document.getElementById('safeDeal').checked = true;
                this.updateTotalAmount();
            }

            updateTotalAmount() {
                const price = parseInt(document.getElementById('taskPrice').value) || 0;
                const commission = Math.floor(price * 0.1);
                const total = price + commission;
                
                const totalElement = document.getElementById('totalAmount');
                if (totalElement) {
                    totalElement.textContent = total;
                }
            }

            // –£–¢–ò–õ–ò–¢–´
            renderCategories() {
                const container = document.getElementById('categoriesGrid');
                if (!container) return;
                
                const categories = [
                    { id: 'design', name: '–î–∏–∑–∞–π–Ω', icon: 'fas fa-palette' },
                    { id: 'development', name: '–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞', icon: 'fas fa-code' },
                    { id: 'text', name: '–¢–µ–∫—Å—Ç—ã', icon: 'fas fa-pen' },
                    { id: 'marketing', name: '–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥', icon: 'fas fa-chart-line' },
                    { id: 'video', name: '–í–∏–¥–µ–æ', icon: 'fas fa-video' },
                    { id: 'audio', name: '–ê—É–¥–∏–æ', icon: 'fas fa-music' }
                ];
                
                container.innerHTML = categories.map(cat => `
                    <div class="category-card" onclick="workVK.filterCategory('${cat.id}')">
                        <i class="${cat.icon}"></i>
                        <span>${cat.name}</span>
                    </div>
                `).join('');
            }

            getCategoryName(category) {
                const categories = {
                    'design': '–î–∏–∑–∞–π–Ω',
                    'development': '–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞',
                    'text': '–¢–µ–∫—Å—Ç—ã',
                    'marketing': '–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥',
                    'video': '–í–∏–¥–µ–æ',
                    'audio': '–ê—É–¥–∏–æ'
                };
                return categories[category] || category;
            }

            showTaskDetails(taskId) {
                this.showNotification('–ü—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–¥–∞–Ω–∏—è: ' + taskId);
                // –ó–¥–µ—Å—å –±—É–¥–µ—Ç –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –¥–µ—Ç–∞–ª—è–º–∏
            }

            filterCategory(category) {
                this.showNotification(`–§–∏–ª—å—Ç—Ä: ${this.getCategoryName(category)}`);
                this.showScreen('tasks');
            }

            showModal(modalId) {
                const modal = document.getElementById(modalId);
                if (modal) {
                    modal.classList.add('active');
                }
            }

            closeModal(modalId) {
                const modal = document.getElementById(modalId);
                if (modal) {
                    modal.classList.remove('active');
                }
            }

            showNotification(message, type = 'success') {
                // –°–æ–∑–¥–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
                const notification = document.createElement('div');
                notification.className = `notification ${type} show`;
                notification.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <i class="fas fa-${type === 'success' ? 'check' : 'exclamation-triangle'}"></i>
                        <span>${message}</span>
                    </div>
                `;
                
                document.body.appendChild(notification);
                
                setTimeout(() => {
                    notification.classList.remove('show');
                    setTimeout(() => {
                        if (notification.parentNode) {
                            notification.parentNode.removeChild(notification);
                        }
                    }, 300);
                }, 3000);
            }

            updateStats() {
                document.getElementById('statsTasks').textContent = this.tasks.length;
                document.getElementById('statsUsers').textContent = '25';
                document.getElementById('statsMoney').textContent = '50K';
            }

            async loadProfileData() {
                try {
                    const response = await fetch('/api/user/stats');
                    const data = await response.json();
                    
                    if (data.success) {
                        document.getElementById('completedTasks').textContent = data.stats.completedTasks;
                        document.getElementById('userRating').textContent = data.stats.rating;
                        document.getElementById('userBalance').textContent = `${data.stats.balance}‚ÇΩ`;
                    }
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ—Ñ–∏–ª—è:', error);
                }
            }

            async loadDealsData() {
                try {
                    const response = await fetch('/api/deals');
                    const data = await response.json();
                    
                    if (data.success) {
                        this.renderDeals(data.deals);
                    }
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–¥–µ–ª–æ–∫:', error);
                }
            }

            renderDeals(deals) {
                const container = document.getElementById('dealsList');
                if (!container) return;

                if (deals.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-handshake"></i>
                            <h3>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç —Å–¥–µ–ª–æ–∫</h3>
                            <p>–ù–∞–π–¥–∏—Ç–µ –∑–∞–¥–∞–Ω–∏–µ –∏ –Ω–∞—á–Ω–∏—Ç–µ —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–æ!</p>
                        </div>
                    `;
                    return;
                }

                container.innerHTML = deals.map(deal => `
                    <div class="task-card">
                        <div class="task-header">
                            <div class="task-title">${deal.taskTitle}</div>
                            <div class="task-price">${deal.amount}‚ÇΩ</div>
                        </div>
                        <div class="task-meta">
                            <span>–°—Ç–∞—Ç—É—Å: ${deal.status}</span>
                        </div>
                    </div>
                `).join('');
            }

            showTab(tabName) {
                // –ü—Ä–æ—Å—Ç–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤–∫–ª–∞–¥–æ–∫
                console.log('–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É:', tabName);
            }
        }

        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
        function showScreen(screenName) {
            if (window.workVK) {
                workVK.showScreen(screenName);
            }
        }

        function showTab(tabName) {
            if (window.workVK) {
                workVK.showTab(tabName);
            }
        }

        function createTask() {
            if (window.workVK) {
                workVK.createTask();
            }
        }

        function vkLogin() {
            if (window.workVK) {
                workVK.vkLogin();
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        let workVK;
        document.addEventListener('DOMContentLoaded', () => {
            workVK = new WorkVK();
            window.workVK = workVK;
        });
    </script>
</body>
</html>